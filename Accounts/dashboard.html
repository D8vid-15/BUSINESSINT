<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accounts Dashboard | Business Management System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --accounts-color: #8b5cf6;
            --accounts-dark: #7c3aed;
            --accounts-light: #ede9fe;
            --light: #f8fafc;
            --dark: #1e293b;
            --gray: #64748b;
            --light-gray: #e2e8f0;
            --warning: #d97706;
            --danger: #dc2626;
            --success: #10b981;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }
        
        body {
            background-color: #f1f5f9;
            color: var(--dark);
            min-height: 100vh;
        }
        
        /* Navigation */
        .navbar {
            background: white;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            padding: 0 20px;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .navbar-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo-icon {
            color: var(--accounts-color);
            font-size: 24px;
        }
        
        .logo-text {
            font-weight: 600;
            font-size: 18px;
            color: var(--dark);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        
        .user-details {
            text-align: right;
        }
        
        .user-name {
            font-weight: 500;
            font-size: 14px;
        }
        
        .user-role {
            font-size: 12px;
            color: var(--gray);
        }
        
        .logout-btn {
            padding: 8px 16px;
            background-color: transparent;
            color: var(--danger);
            border: 1px solid var(--danger);
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .logout-btn:hover {
            background-color: var(--danger);
            color: white;
        }
        
        /* Dashboard Layout */
        .dashboard-container {
            display: flex;
            min-height: calc(100vh - 68px);
            max-width: 1400px;
            margin: 0 auto;
        }
        
        /* Sidebar */
        .sidebar {
            width: 240px;
            background: white;
            border-right: 1px solid var(--light-gray);
            padding: 24px 0;
            display: flex;
            flex-direction: column;
        }
        
        .sidebar-header {
            padding: 0 24px 20px;
            border-bottom: 1px solid var(--light-gray);
            margin-bottom: 20px;
        }
        
        .sidebar-title {
            font-size: 14px;
            color: var(--gray);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }
        
        .sidebar-menu {
            list-style: none;
            flex: 1;
        }
        
        .menu-item {
            padding: 14px 24px;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            transition: all 0.2s;
            border-left: 4px solid transparent;
            font-size: 14px;
            color: var(--dark);
        }
        
        .menu-item:hover {
            background-color: var(--accounts-light);
        }
        
        .menu-item.active {
            background-color: var(--accounts-light);
            border-left-color: var(--accounts-color);
            color: var(--accounts-color);
            font-weight: 500;
        }
        
        .menu-item i {
            width: 20px;
            text-align: center;
        }
        
        /* Main Content */
        .main-content {
            flex: 1;
            padding: 32px;
            min-width: 0;
        }
        
        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
        }
        
        .dashboard-header h1 {
            font-size: 24px;
            color: var(--dark);
            font-weight: 600;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-primary {
            background-color: var(--accounts-color);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--accounts-dark);
        }
        
        .btn-secondary {
            background-color: var(--light-gray);
            color: var(--dark);
        }
        
        .btn-secondary:hover {
            background-color: #d1d5db;
        }
        
        /* Stats Cards */
        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }
        
        .stat-card {
            background: white;
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--light-gray);
        }
        
        .stat-card h3 {
            font-size: 13px;
            color: var(--gray);
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }
        
        .stat-card .value {
            font-size: 28px;
            font-weight: 600;
            margin-bottom: 4px;
            color: var(--dark);
        }
        
        .stat-card .subtext {
            font-size: 13px;
            color: var(--gray);
        }
        
        /* Tables */
        .card {
            background: white;
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--light-gray);
            margin-bottom: 24px;
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .card-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--dark);
        }
        
        .table-container {
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }
        
        thead {
            background-color: #f8fafc;
        }
        
        th {
            padding: 12px 16px;
            text-align: left;
            font-weight: 600;
            color: var(--gray);
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 1px solid var(--light-gray);
            white-space: nowrap;
        }
        
        td {
            padding: 16px;
            border-bottom: 1px solid var(--light-gray);
            vertical-align: middle;
        }
        
        tr:hover {
            background-color: #f8fafc;
        }
        
        .status-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .status-pending {
            background-color: #fef3c7;
            color: #92400e;
        }
        
        .status-approved {
            background-color: var(--accounts-light);
            color: var(--accounts-dark);
        }
        
        .status-paid {
            background-color: #d1fae5;
            color: #065f46;
        }
        
        .status-rejected {
            background-color: #fee2e2;
            color: #991b1b;
        }
        
        .status-pending-accounts {
            background-color: #f0f9ff;
            color: #0ea5e9;
        }
        
        .status-pending-release {
            background-color: #fef3c7;
            color: #92400e;
        }
        
        .action-buttons {
            display: flex;
            gap: 8px;
        }
        
        .action-btn {
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            border: 1px solid transparent;
            transition: all 0.2s;
            background: none;
        }
        
        .action-btn.view {
            background-color: #f0f9ff;
            color: #0ea5e9;
            border-color: #0ea5e9;
        }
        
        .action-btn.view:hover {
            background-color: #0ea5e9;
            color: white;
        }
        
        .action-btn.approve {
            background-color: var(--accounts-light);
            color: var(--accounts-color);
            border-color: var(--accounts-color);
        }
        
        .action-btn.approve:hover {
            background-color: var(--accounts-color);
            color: white;
        }
        
        .action-btn.reject {
            background-color: #fee2e2;
            color: var(--danger);
            border-color: var(--danger);
        }
        
        .action-btn.reject:hover {
            background-color: var(--danger);
            color: white;
        }
        
        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 48px 24px;
            color: var(--gray);
        }
        
        .empty-state i {
            font-size: 48px;
            margin-bottom: 16px;
            color: var(--light-gray);
        }
        
        .empty-state h3 {
            font-size: 18px;
            margin-bottom: 8px;
            color: var(--dark);
        }
        
        /* Payment Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: white;
            border-radius: 8px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-header {
            padding: 20px 24px;
            border-bottom: 1px solid var(--light-gray);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-title {
            font-size: 18px;
            font-weight: 600;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--gray);
        }
        
        .modal-body {
            padding: 24px;
        }
        
        .order-details {
            background-color: #f8fafc;
            border-radius: 6px;
            padding: 16px;
            margin-bottom: 20px;
        }
        
        .detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .detail-row:last-child {
            margin-bottom: 0;
            font-weight: 600;
            border-top: 1px solid var(--light-gray);
            padding-top: 8px;
        }
        
        /* Form Styles */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
            font-size: 14px;
        }
        
        .form-control {
            width: 100%;
            padding: 10px 14px;
            border: 1px solid var(--light-gray);
            border-radius: 6px;
            font-size: 14px;
            transition: all 0.2s;
            background-color: white;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--accounts-color);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }
        
        textarea.form-control {
            min-height: 100px;
            resize: vertical;
        }
        
        /* Workflow Timeline */
        .workflow-timeline {
            position: relative;
            margin: 20px 0;
            padding-left: 30px;
        }
        
        .workflow-timeline::before {
            content: '';
            position: absolute;
            left: 15px;
            top: 0;
            bottom: 0;
            width: 2px;
            background-color: var(--light-gray);
        }
        
        .workflow-step {
            position: relative;
            margin-bottom: 20px;
        }
        
        .workflow-step:last-child {
            margin-bottom: 0;
        }
        
        .workflow-marker {
            position: absolute;
            left: -30px;
            top: 0;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: var(--light-gray);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }
        
        .workflow-marker.active {
            background-color: var(--accounts-color);
        }
        
        .workflow-marker.completed {
            background-color: var(--success);
        }
        
        .workflow-content {
            background: white;
            border: 1px solid var(--light-gray);
            border-radius: 6px;
            padding: 16px;
        }
        
        /* Responsive */
        @media (max-width: 1024px) {
            .sidebar {
                width: 200px;
            }
            
            .main-content {
                padding: 24px;
            }
        }
        
        @media (max-width: 768px) {
            .dashboard-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                flex-direction: row;
                padding: 0;
                overflow-x: auto;
                border-right: none;
                border-bottom: 1px solid var(--light-gray);
            }
            
            .sidebar-header {
                display: none;
            }
            
            .sidebar-menu {
                display: flex;
                flex: 1;
                padding: 0;
            }
            
            .menu-item {
                padding: 16px 20px;
                border-left: none;
                border-bottom: 4px solid transparent;
                white-space: nowrap;
            }
            
            .menu-item.active {
                border-left: none;
                border-bottom-color: var(--accounts-color);
            }
            
            .stats-cards {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="navbar-content">
            <div class="logo">
                <i class="fas fa-file-invoice-dollar logo-icon"></i>
                <span class="logo-text">Accounts Department</span>
            </div>
            
            <div class="user-info">
                <div class="user-details">
                    <div class="user-name" id="userName">Accounts User</div>
                    <div class="user-role">Accounts Department</div>
                </div>
                <button class="logout-btn" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
        </div>
    </nav>
    
    <!-- Dashboard Layout -->
    <div class="dashboard-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-title">Accounts Portal</div>
            </div>
            
            <ul class="sidebar-menu">
                <li class="menu-item active" data-page="dashboard">
                    <i class="fas fa-chart-line"></i>
                    <span>Dashboard</span>
                </li>
                <li class="menu-item" data-page="pending-approvals">
                    <i class="fas fa-clock"></i>
                    <span>Pending Approvals</span>
                </li>
                <li class="menu-item" data-page="approved-orders">
                    <i class="fas fa-check-circle"></i>
                    <span>Approved Orders</span>
                </li>
                <li class="menu-item" data-page="rejected-orders">
                    <i class="fas fa-times-circle"></i>
                    <span>Rejected Orders</span>
                </li>
                <li class="menu-item" data-page="reports">
                    <i class="fas fa-chart-bar"></i>
                    <span>Reports</span>
                </li>
            </ul>
        </aside>
        
        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Page -->
            <div id="dashboardPage" class="page-content">
                <div class="dashboard-header">
                    <h1>Accounts Dashboard</h1>
                    <div class="btn-group">
                        <button class="btn btn-primary" id="processBatchBtn">
                            <i class="fas fa-bolt"></i> Bulk Process
                        </button>
                    </div>
                </div>
                
                <!-- Stats Cards -->
                <div class="stats-cards">
                    <div class="stat-card">
                        <h3>Pending Approvals</h3>
                        <div class="value" id="pendingApprovalsCount">0</div>
                        <div class="subtext">Awaiting payment verification</div>
                    </div>
                    
                    <div class="stat-card">
                        <h3>Today's Approvals</h3>
                        <div class="value" id="todayApprovalsCount">0</div>
                        <div class="subtext">Approved today</div>
                    </div>
                    
                    <div class="stat-card">
                        <h3>Month Revenue</h3>
                        <div class="value" id="monthRevenue">₦0</div>
                        <div class="subtext">Verified payments</div>
                    </div>
                    
                    <div class="stat-card">
                        <h3>Processing Rate</h3>
                        <div class="value" id="processingRate">0%</div>
                        <div class="subtext">Orders processed</div>
                    </div>
                </div>
                
                <!-- Recent Pending Approvals -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Recent Pending Approvals</h2>
                        <button class="btn btn-secondary" id="viewAllPendingBtn">
                            View All
                        </button>
                    </div>
                    
                    <div class="table-container">
                        <table id="recentPendingTable">
                            <thead>
                                <tr>
                                    <th>Order ID</th>
                                    <th>Customer</th>
                                    <th>Amount</th>
                                    <th>Order Date</th>
                                    <th>Sales Person</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Orders will be loaded dynamically -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="empty-state" id="noPendingApprovals" style="display: none;">
                        <i class="fas fa-check-circle"></i>
                        <h3>No Pending Approvals</h3>
                        <p>All orders are up to date</p>
                    </div>
                </div>
                
                <!-- Workflow Information -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Order Workflow</h2>
                    </div>
                    
                    <div class="workflow-timeline">
                        <div class="workflow-step">
                            <div class="workflow-marker completed">1</div>
                            <div class="workflow-content">
                                <div style="font-weight: 600; margin-bottom: 4px;">Sales Order Created</div>
                                <div style="font-size: 13px; color: var(--gray);">
                                    Sales department creates order with carton details
                                </div>
                            </div>
                        </div>
                        
                        <div class="workflow-step">
                            <div class="workflow-marker active">2</div>
                            <div class="workflow-content">
                                <div style="font-weight: 600; margin-bottom: 4px;">Accounts Verification</div>
                                <div style="font-size: 13px; color: var(--gray);">
                                    Accounts department verifies payment and approves order
                                </div>
                            </div>
                        </div>
                        
                        <div class="workflow-step">
                            <div class="workflow-marker">3</div>
                            <div class="workflow-content">
                                <div style="font-weight: 600; margin-bottom: 4px;">Store Release</div>
                                <div style="font-size: 13px; color: var(--gray);">
                                    Store department releases goods after payment approval
                                </div>
                            </div>
                        </div>
                        
                        <div class="workflow-step">
                            <div class="workflow-marker">4</div>
                            <div class="workflow-content">
                                <div style="font-weight: 600; margin-bottom: 4px;">Delivery Complete</div>
                                <div style="font-size: 13px; color: var(--gray);">
                                    Order delivered to customer and marked complete
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Pending Approvals Page -->
            <div id="pending-approvalsPage" class="page-content" style="display: none;">
                <div class="dashboard-header">
                    <h1>Pending Approvals</h1>
                    <div>
                        <input type="text" class="form-control" id="searchOrders" placeholder="Search orders..." style="width: 200px; display: inline-block; margin-right: 12px;">
                        <select class="form-control" id="orderFilter" style="width: auto; display: inline-block; margin-right: 12px;">
                            <option value="all">All Pending</option>
                            <option value="today">Today's Orders</option>
                            <option value="week">This Week</option>
                        </select>
                    </div>
                </div>
                
                <div class="card">
                    <div class="table-container">
                        <table id="allPendingTable">
                            <thead>
                                <tr>
                                    <th>Order ID</th>
                                    <th>Customer</th>
                                    <th>Items</th>
                                    <th>Cartons</th>
                                    <th>Amount</th>
                                    <th>Order Date</th>
                                    <th>Payment Method</th>
                                    <th>Sales Person</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Pending orders will be loaded dynamically -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="empty-state" id="noPendingOrders" style="display: none;">
                        <i class="fas fa-search"></i>
                        <h3>No Pending Orders</h3>
                        <p>No orders require payment verification</p>
                    </div>
                </div>
            </div>
            
            <!-- Approved Orders Page -->
            <div id="approved-ordersPage" class="page-content" style="display: none;">
                <div class="dashboard-header">
                    <h1>Approved Orders</h1>
                    <div>
                        <input type="date" class="form-control" id="approvedDateFrom" style="width: auto; display: inline-block; margin-right: 8px;">
                        <input type="date" class="form-control" id="approvedDateTo" style="width: auto; display: inline-block; margin-right: 12px;">
                        <button class="btn btn-secondary" id="filterApprovedBtn">
                            <i class="fas fa-filter"></i> Filter
                        </button>
                    </div>
                </div>
                
                <div class="card">
                    <div class="table-container">
                        <table id="approvedTable">
                            <thead>
                                <tr>
                                    <th>Order ID</th>
                                    <th>Customer</th>
                                    <th>Amount</th>
                                    <th>Approval Date</th>
                                    <th>Approved By</th>
                                    <th>Payment Reference</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Approved orders will be loaded dynamically -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="empty-state" id="noApprovedOrders" style="display: none;">
                        <i class="fas fa-file-invoice-dollar"></i>
                        <h3>No Approved Orders</h3>
                        <p>No orders have been approved yet</p>
                    </div>
                </div>
            </div>
            
            <!-- Rejected Orders Page -->
            <div id="rejected-ordersPage" class="page-content" style="display: none;">
                <div class="dashboard-header">
                    <h1>Rejected Orders</h1>
                    <div>
                        <input type="date" class="form-control" id="rejectedDateFrom" style="width: auto; display: inline-block; margin-right: 8px;">
                        <input type="date" class="form-control" id="rejectedDateTo" style="width: auto; display: inline-block; margin-right: 12px;">
                        <button class="btn btn-secondary" id="filterRejectedBtn">
                            <i class="fas fa-filter"></i> Filter
                        </button>
                    </div>
                </div>
                
                <div class="card">
                    <div class="table-container">
                        <table id="rejectedTable">
                            <thead>
                                <tr>
                                    <th>Order ID</th>
                                    <th>Customer</th>
                                    <th>Amount</th>
                                    <th>Rejection Date</th>
                                    <th>Rejected By</th>
                                    <th>Reason</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Rejected orders will be loaded dynamically -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="empty-state" id="noRejectedOrders" style="display: none;">
                        <i class="fas fa-times-circle"></i>
                        <h3>No Rejected Orders</h3>
                        <p>No orders have been rejected yet</p>
                    </div>
                </div>
            </div>
            
            <!-- Reports Page -->
            <div id="reportsPage" class="page-content" style="display: none;">
                <div class="dashboard-header">
                    <h1>Accounts Reports</h1>
                    <div>
                        <select class="form-control" id="reportPeriod" style="width: auto; display: inline-block; margin-right: 12px;">
                            <option value="today">Today</option>
                            <option value="week">This Week</option>
                            <option value="month">This Month</option>
                            <option value="quarter">This Quarter</option>
                        </select>
                        <button class="btn btn-primary" id="generateReportBtn">
                            <i class="fas fa-download"></i> Generate Report
                        </button>
                    </div>
                </div>
                
                <div class="card">
                    <div class="empty-state">
                        <i class="fas fa-chart-bar"></i>
                        <h3>Financial Reports</h3>
                        <p>Accounts reports and analytics will be displayed here</p>
                        <div style="margin-top: 20px;">
                            <button class="btn btn-secondary">
                                <i class="fas fa-file-excel"></i> Export to Excel
                            </button>
                            <button class="btn btn-secondary" style="margin-left: 10px;">
                                <i class="fas fa-print"></i> Print Report
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <!-- Payment Approval Modal -->
    <div class="modal" id="approvalModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Verify and Approve Order</h2>
                <button class="close-btn" id="closeModal">&times;</button>
            </div>
            
            <div class="modal-body">
                <div class="order-details">
                    <div class="detail-row">
                        <span>Order ID:</span>
                        <span id="modalOrderId">-</span>
                    </div>
                    <div class="detail-row">
                        <span>Customer:</span>
                        <span id="modalCustomer">-</span>
                    </div>
                    <div class="detail-row">
                        <span>Order Date:</span>
                        <span id="modalOrderDate">-</span>
                    </div>
                    <div class="detail-row">
                        <span>Delivery Date:</span>
                        <span id="modalDeliveryDate">-</span>
                    </div>
                    <div class="detail-row">
                        <span>Sales Person:</span>
                        <span id="modalSalesPerson">-</span>
                    </div>
                    <div class="detail-row">
                        <span>Payment Method:</span>
                        <span id="modalPaymentMethod">-</span>
                    </div>
                    <div class="detail-row">
                        <span>Total Cartons:</span>
                        <span id="modalTotalCartons">0</span>
                    </div>
                    <div class="detail-row">
                        <span>Total Amount:</span>
                        <span id="modalAmount" style="font-weight: 600; color: var(--accounts-color);">₦0</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Order Items:</label>
                    <div id="orderItemsList" style="background-color: #f8fafc; padding: 12px; border-radius: 6px; font-size: 13px;">
                        <!-- Order items will be displayed here -->
                    </div>
                </div>
                
                <form id="approvalForm">
                    <div class="form-group">
                        <label for="paymentVerification">Payment Verification *</label>
                        <select id="paymentVerification" class="form-control" required>
                            <option value="">Select Verification Status</option>
                            <option value="verified_cash">Cash Payment Verified</option>
                            <option value="verified_transfer">Bank Transfer Verified</option>
                            <option value="verified_pos">POS Payment Verified</option>
                            <option value="not_verified">Payment Not Verified</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="paymentReference">Payment Reference / Receipt No. *</label>
                        <input type="text" id="paymentReference" class="form-control" placeholder="Enter reference number" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="verificationDate">Verification Date *</label>
                        <input type="date" id="verificationDate" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="approvalNotes">Notes (Optional)</label>
                        <textarea id="approvalNotes" class="form-control" placeholder="Add any notes about this verification..."></textarea>
                    </div>
                    
                    <div style="display: flex; gap: 12px; margin-top: 24px;">
                        <button type="submit" class="btn btn-primary" style="flex: 1;">
                            <i class="fas fa-check-circle"></i> Approve Payment
                        </button>
                        <button type="button" class="btn btn-secondary" id="rejectOrderBtn" style="flex: 1;">
                            <i class="fas fa-times-circle"></i> Reject Order
                        </button>
                        <button type="button" class="btn btn-secondary" id="cancelApprovalBtn">
                            Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Data from sales department
        let salesOrders = JSON.parse(localStorage.getItem('sales_orders') || '[]');
        let accountsUser = JSON.parse(localStorage.getItem('accounts_user') || '{}');
        let currentOrder = null;
        
        // DOM Elements
        const pages = {
            dashboard: document.getElementById('dashboardPage'),
            'pending-approvals': document.getElementById('pending-approvalsPage'),
            'approved-orders': document.getElementById('approved-ordersPage'),
            'rejected-orders': document.getElementById('rejected-ordersPage'),
            reports: document.getElementById('reportsPage')
        };
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Check authentication
            const isAuthenticated = localStorage.getItem('accounts_authenticated');
            if (!isAuthenticated) {
                window.location.href = 'login.html';
                return;
            }
            
            // Load user data
            if (accountsUser.name) {
                document.getElementById('userName').textContent = accountsUser.name;
            }
            
            // Initialize data
            initializeData();
            
            // Set up event listeners
            setupEventListeners();
            
            // Set today's date for verification
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('verificationDate').value = today;
            
            // Load initial view
            showPage('dashboard');
            updateDashboardStats();
            loadRecentPendingOrders();
        });
        
        function initializeData() {
            // Ensure accounts data structure exists
            if (!localStorage.getItem('accounts_processed_orders')) {
                localStorage.setItem('accounts_processed_orders', JSON.stringify([]));
            }
            
            // Sync with sales orders
            syncWithSalesOrders();
        }
        
        function syncWithSalesOrders() {
            // Get pending approvals from sales orders
            const pendingOrders = salesOrders.filter(order => 
                order.status === 'pending-accounts'
            );
            
            // Get approved orders
            const approvedOrders = salesOrders.filter(order => 
                order.status === 'approved' || order.status === 'pending-release'
            );
            
            // Get rejected orders (would need to track in sales orders)
            const rejectedOrders = salesOrders.filter(order => 
                order.status === 'rejected'
            );
            
            // Update localStorage for quick access
            localStorage.setItem('accounts_pending_orders', JSON.stringify(pendingOrders));
            localStorage.setItem('accounts_approved_orders', JSON.stringify(approvedOrders));
            localStorage.setItem('accounts_rejected_orders', JSON.stringify(rejectedOrders));
        }
        
        function getPendingOrders() {
            return salesOrders.filter(order => order.status === 'pending-accounts');
        }
        
        function getApprovedOrders() {
            return salesOrders.filter(order => 
                order.status === 'approved' || order.status === 'pending-release' || order.status === 'delivered'
            );
        }
        
        function getRejectedOrders() {
            return salesOrders.filter(order => order.status === 'rejected');
        }
        
        function showPage(pageName) {
            // Hide all pages
            Object.values(pages).forEach(page => {
                if (page) page.style.display = 'none';
            });
            
            // Remove active class from all menu items
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Show selected page
            if (pages[pageName]) {
                pages[pageName].style.display = 'block';
            }
            
            // Add active class to selected menu item
            const menuItem = document.querySelector(`.menu-item[data-page="${pageName}"]`);
            if (menuItem) {
                menuItem.classList.add('active');
            }
            
            // Update page-specific data
            if (pageName === 'dashboard') {
                updateDashboardStats();
                loadRecentPendingOrders();
            } else if (pageName === 'pending-approvals') {
                loadAllPendingOrders();
            } else if (pageName === 'approved-orders') {
                loadApprovedOrders();
            } else if (pageName === 'rejected-orders') {
                loadRejectedOrders();
            }
        }
        
        function updateDashboardStats() {
            const now = new Date();
            const today = now.toISOString().split('T')[0];
            
            // Calculate stats
            const pendingOrders = getPendingOrders();
            const approvedOrders = getApprovedOrders();
            
            // Pending approvals count
            const pendingCount = pendingOrders.length;
            
            // Today's approvals
            const todayApprovals = approvedOrders.filter(order => {
                const orderDate = new Date(order.orderDate).toISOString().split('T')[0];
                return orderDate === today;
            }).length;
            
            // Month revenue (only approved orders)
            const currentMonth = now.getMonth();
            const currentYear = now.getFullYear();
            const monthRevenue = approvedOrders
                .filter(order => {
                    const orderDate = new Date(order.orderDate);
                    return orderDate.getMonth() === currentMonth && 
                           orderDate.getFullYear() === currentYear;
                })
                .reduce((sum, order) => sum + order.totalValue, 0);
            
            // Processing rate
            const totalOrders = salesOrders.filter(order => order.status !== 'draft').length;
            const processedOrders = approvedOrders.length + getRejectedOrders().length;
            const processingRate = totalOrders > 0 ? Math.round((processedOrders / totalOrders) * 100) : 0;
            
            // Update UI
            document.getElementById('pendingApprovalsCount').textContent = pendingCount;
            document.getElementById('todayApprovalsCount').textContent = todayApprovals;
            document.getElementById('monthRevenue').textContent = `₦${monthRevenue.toLocaleString()}`;
            document.getElementById('processingRate').textContent = `${processingRate}%`;
        }
        
        function loadRecentPendingOrders() {
            const tableBody = document.querySelector('#recentPendingTable tbody');
            const emptyState = document.getElementById('noPendingApprovals');
            const pendingOrders = getPendingOrders();
            
            if (pendingOrders.length === 0) {
                tableBody.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }
            
            emptyState.style.display = 'none';
            
            // Sort by order date (newest first) and get recent 10 orders
            const recentOrders = [...pendingOrders]
                .sort((a, b) => new Date(b.orderDate) - new Date(a.orderDate))
                .slice(0, 10);
            
            tableBody.innerHTML = recentOrders.map(order => {
                const orderDate = new Date(order.orderDate);
                const formattedDate = orderDate.toLocaleDateString('en-NG', { 
                    day: 'numeric',
                    month: 'short'
                });
                
                // Get items summary
                const itemsSummary = order.items.map(item => 
                    `${item.product} (${item.totalCartons})`
                ).join(', ');
                
                return `
                    <tr>
                        <td>${order.id}</td>
                        <td>${order.customerName}</td>
                        <td>₦${order.totalValue.toLocaleString()}</td>
                        <td>${formattedDate}</td>
                        <td>${order.salesRep}</td>
                        <td>
                            <div class="action-buttons">
                                <button class="action-btn view" onclick="viewOrderDetails('${order.id}')">
                                    <i class="fas fa-eye"></i> View
                                </button>
                                <button class="action-btn approve" onclick="approveOrder('${order.id}')">
                                    <i class="fas fa-check"></i> Approve
                                </button>
                                <button class="action-btn reject" onclick="rejectOrder('${order.id}')">
                                    <i class="fas fa-times"></i> Reject
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }
        
        function loadAllPendingOrders() {
            const tableBody = document.querySelector('#allPendingTable tbody');
            const emptyState = document.getElementById('noPendingOrders');
            const searchTerm = document.getElementById('searchOrders').value.toLowerCase();
            const filter = document.getElementById('orderFilter').value;
            
            let pendingOrders = getPendingOrders();
            
            // Apply search filter
            if (searchTerm) {
                pendingOrders = pendingOrders.filter(order => 
                    order.id.toLowerCase().includes(searchTerm) ||
                    order.customerName.toLowerCase().includes(searchTerm) ||
                    order.salesRep.toLowerCase().includes(searchTerm)
                );
            }
            
            // Apply date filter
            if (filter === 'today') {
                const today = new Date().toISOString().split('T')[0];
                pendingOrders = pendingOrders.filter(order => 
                    order.orderDate === today
                );
            } else if (filter === 'week') {
                const weekAgo = new Date();
                weekAgo.setDate(weekAgo.getDate() - 7);
                pendingOrders = pendingOrders.filter(order => 
                    new Date(order.orderDate) >= weekAgo
                );
            }
            
            if (pendingOrders.length === 0) {
                tableBody.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }
            
            emptyState.style.display = 'none';
            
            // Sort by order date (newest first)
            const sortedOrders = [...pendingOrders].sort((a, b) => 
                new Date(b.orderDate) - new Date(a.orderDate)
            );
            
            tableBody.innerHTML = sortedOrders.map(order => {
                const orderDate = new Date(order.orderDate);
                const formattedDate = orderDate.toLocaleDateString('en-NG', { 
                    day: 'numeric',
                    month: 'short',
                    year: 'numeric'
                });
                
                // Get items summary
                const itemsSummary = order.items.map(item => 
                    `${item.product}`
                ).join(', ');
                
                return `
                    <tr>
                        <td>${order.id}</td>
                        <td>${order.customerName}</td>
                        <td>${itemsSummary}</td>
                        <td>${order.totalCartons}</td>
                        <td>₦${order.totalValue.toLocaleString()}</td>
                        <td>${formattedDate}</td>
                        <td>${formatPaymentMethod(order.paymentMethod)}</td>
                        <td>${order.salesRep}</td>
                        <td>
                            <div class="action-buttons">
                                <button class="action-btn view" onclick="viewOrderDetails('${order.id}')">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="action-btn approve" onclick="approveOrder('${order.id}')">
                                    <i class="fas fa-check"></i>
                                </button>
                                <button class="action-btn reject" onclick="rejectOrder('${order.id}')">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }
        
        function loadApprovedOrders() {
            const tableBody = document.querySelector('#approvedTable tbody');
            const emptyState = document.getElementById('noApprovedOrders');
            const approvedOrders = getApprovedOrders();
            
            if (approvedOrders.length === 0) {
                tableBody.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }
            
            emptyState.style.display = 'none';
            
            // Sort by order date (newest first)
            const sortedOrders = [...approvedOrders].sort((a, b) => 
                new Date(b.orderDate) - new Date(a.orderDate)
            );
            
            tableBody.innerHTML = sortedOrders.map(order => {
                const orderDate = new Date(order.orderDate);
                const formattedDate = orderDate.toLocaleDateString('en-NG', { 
                    day: 'numeric',
                    month: 'short',
                    year: 'numeric'
                });
                
                // Find when it was approved (from workflow)
                const approvalStep = order.workflow?.find(step => step.step === 'accounts');
                const approvedBy = approvalStep?.user || 'Unknown';
                const approvalDate = approvalStep?.date || order.orderDate;
                
                return `
                    <tr>
                        <td>${order.id}</td>
                        <td>${order.customerName}</td>
                        <td>₦${order.totalValue.toLocaleString()}</td>
                        <td>${approvalDate}</td>
                        <td>${approvedBy}</td>
                        <td>${order.paymentMethod === 'transfer' ? 'Bank Transfer' : order.paymentMethod?.toUpperCase() || 'N/A'}</td>
                        <td><span class="status-badge status-${order.status}">${getStatusText(order.status)}</span></td>
                        <td>
                            <div class="action-buttons">
                                <button class="action-btn view" onclick="viewOrderDetails('${order.id}')">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }
        
        function loadRejectedOrders() {
            const tableBody = document.querySelector('#rejectedTable tbody');
            const emptyState = document.getElementById('noRejectedOrders');
            const rejectedOrders = getRejectedOrders();
            
            if (rejectedOrders.length === 0) {
                tableBody.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }
            
            emptyState.style.display = 'none';
            
            // Sort by order date (newest first)
            const sortedOrders = [...rejectedOrders].sort((a, b) => 
                new Date(b.orderDate) - new Date(a.orderDate)
            );
            
            tableBody.innerHTML = sortedOrders.map(order => {
                const orderDate = new Date(order.orderDate);
                const formattedDate = orderDate.toLocaleDateString('en-NG', { 
                    day: 'numeric',
                    month: 'short',
                    year: 'numeric'
                });
                
                // Find rejection info
                const rejectionNotes = order.rejectionNotes || 'No reason provided';
                
                return `
                    <tr>
                        <td>${order.id}</td>
                        <td>${order.customerName}</td>
                        <td>₦${order.totalValue.toLocaleString()}</td>
                        <td>${formattedDate}</td>
                        <td>${order.rejectedBy || 'Unknown'}</td>
                        <td>${rejectionNotes}</td>
                        <td>
                            <div class="action-buttons">
                                <button class="action-btn view" onclick="viewOrderDetails('${order.id}')">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }
        
        function viewOrderDetails(orderId) {
            const order = salesOrders.find(o => o.id === orderId);
            if (!order) return;
            
            let details = `Order ID: ${order.id}\n`;
            details += `Customer: ${order.customerName}\n`;
            details += `Order Date: ${order.orderDate}\n`;
            details += `Delivery Date: ${order.deliveryDate}\n`;
            details += `Status: ${getStatusText(order.status)}\n`;
            details += `Payment Method: ${formatPaymentMethod(order.paymentMethod)}\n`;
            details += `Sales Rep: ${order.salesRep}\n`;
            details += `Total Cartons: ${order.totalCartons}\n`;
            details += `Total Value: ₦${order.totalValue.toLocaleString()}\n\n`;
            
            details += `Order Items:\n`;
            order.items.forEach((item, index) => {
                details += `${index + 1}. ${item.product}:\n`;
                if (item.carton1L > 0) details += `   - 1L: ${item.carton1L} cartons\n`;
                if (item.carton4L > 0) details += `   - 4L: ${item.carton4L} cartons\n`;
                if (item.carton5L > 0) details += `   - 5L: ${item.carton5L} cartons\n`;
                if (item.carton25L > 0) details += `   - 25L: ${item.carton25L} cartons\n`;
                details += `   Subtotal: ${item.totalCartons} cartons = ₦${item.totalValue.toLocaleString()}\n\n`;
            });
            
            if (order.notes) {
                details += `Notes: ${order.notes}\n`;
            }
            
            alert(details);
        }
        
        function approveOrder(orderId) {
            const order = salesOrders.find(o => o.id === orderId);
            if (!order) return;
            
            currentOrder = order;
            
            // Fill modal with order data
            document.getElementById('modalOrderId').textContent = order.id;
            document.getElementById('modalCustomer').textContent = order.customerName;
            document.getElementById('modalOrderDate').textContent = formatDate(order.orderDate);
            document.getElementById('modalDeliveryDate').textContent = formatDate(order.deliveryDate);
            document.getElementById('modalSalesPerson').textContent = order.salesRep;
            document.getElementById('modalPaymentMethod').textContent = formatPaymentMethod(order.paymentMethod);
            document.getElementById('modalTotalCartons').textContent = order.totalCartons;
            document.getElementById('modalAmount').textContent = `₦${order.totalValue.toLocaleString()}`;
            
            // Display order items
            const itemsList = document.getElementById('orderItemsList');
            itemsList.innerHTML = order.items.map((item, index) => {
                let sizes = [];
                if (item.carton1L > 0) sizes.push(`1L: ${item.carton1L}`);
                if (item.carton4L > 0) sizes.push(`4L: ${item.carton4L}`);
                if (item.carton5L > 0) sizes.push(`5L: ${item.carton5L}`);
                if (item.carton25L > 0) sizes.push(`25L: ${item.carton25L}`);
                
                return `
                    <div style="margin-bottom: ${index < order.items.length - 1 ? '8px' : '0'}; padding-bottom: ${index < order.items.length - 1 ? '8px' : '0'}; border-bottom: ${index < order.items.length - 1 ? '1px solid #e2e8f0' : 'none'}">
                        <div style="font-weight: 600;">${item.product}</div>
                        <div>${sizes.join(', ')} cartons</div>
                        <div>Subtotal: ₦${item.totalValue.toLocaleString()}</div>
                    </div>
                `;
            }).join('');
            
            // Show modal
            document.getElementById('approvalModal').style.display = 'flex';
        }
        
        function processApproval() {
            const paymentVerification = document.getElementById('paymentVerification').value;
            const paymentReference = document.getElementById('paymentReference').value;
            const verificationDate = document.getElementById('verificationDate').value;
            const approvalNotes = document.getElementById('approvalNotes').value;
            
            if (!paymentVerification || !paymentReference || !verificationDate) {
                alert('Please fill in all required fields.');
                return;
            }
            
            if (!currentOrder) return;
            
            if (paymentVerification === 'not_verified') {
                alert('Cannot approve order without payment verification. Please reject the order instead.');
                return;
            }
            
            // Update the order status
            const orderIndex = salesOrders.findIndex(o => o.id === currentOrder.id);
            if (orderIndex === -1) return;
            
            // Update order status
            salesOrders[orderIndex].status = 'approved';
            salesOrders[orderIndex].paymentStatus = 'approved';
            
            // Update workflow
            if (salesOrders[orderIndex].workflow) {
                const workflowIndex = salesOrders[orderIndex].workflow.findIndex(step => step.step === 'accounts');
                if (workflowIndex !== -1) {
                    salesOrders[orderIndex].workflow[workflowIndex].status = 'completed';
                    salesOrders[orderIndex].workflow[workflowIndex].date = verificationDate;
                    salesOrders[orderIndex].workflow[workflowIndex].user = accountsUser.name || 'Accounts User';
                }
            }
            
            // Add accounts approval details
            salesOrders[orderIndex].accountsApproval = {
                verifiedBy: accountsUser.name || 'Accounts User',
                verificationDate: verificationDate,
                paymentReference: paymentReference,
                verificationStatus: paymentVerification,
                notes: approvalNotes
            };
            
            // Save to localStorage
            localStorage.setItem('sales_orders', JSON.stringify(salesOrders));
            
            // Create pending release for store department
            createStoreRelease(currentOrder.id);
            
            // Close modal
            document.getElementById('approvalModal').style.display = 'none';
            
            // Reset form
            document.getElementById('approvalForm').reset();
            document.getElementById('verificationDate').value = new Date().toISOString().split('T')[0];
            
            // Show success message
            alert(`Order ${currentOrder.id} approved successfully!\n\nPayment Reference: ${paymentReference}\nAmount: ₦${currentOrder.totalValue.toLocaleString()}\n\nOrder has been sent to Store Department for release.`);
            
            // Update UI
            updateDashboardStats();
            loadRecentPendingOrders();
            if (document.getElementById('pending-approvalsPage').style.display !== 'none') {
                loadAllPendingOrders();
            }
            
            currentOrder = null;
        }
        
        function rejectOrder(orderId, quickReject = false) {
            const order = salesOrders.find(o => o.id === orderId);
            if (!order) return;
            
            if (quickReject) {
                // Quick reject without modal
                if (!confirm(`Reject order ${orderId}? This will notify the Sales Department.`)) {
                    return;
                }
                
                const reason = prompt('Please enter reason for rejection:', 'Payment not verified');
                if (reason === null) return;
                
                rejectOrderProcess(orderId, reason);
                return;
            }
            
            currentOrder = order;
            const reason = prompt('Please enter reason for rejection:', 'Payment not verified');
            if (reason === null) return;
            
            rejectOrderProcess(orderId, reason);
        }
        
        function rejectOrderProcess(orderId, reason) {
            const orderIndex = salesOrders.findIndex(o => o.id === orderId);
            if (orderIndex === -1) return;
            
            // Update order status
            salesOrders[orderIndex].status = 'rejected';
            salesOrders[orderIndex].paymentStatus = 'rejected';
            salesOrders[orderIndex].rejectionNotes = reason;
            salesOrders[orderIndex].rejectedBy = accountsUser.name || 'Accounts User';
            salesOrders[orderIndex].rejectionDate = new Date().toISOString().split('T')[0];
            
            // Save to localStorage
            localStorage.setItem('sales_orders', JSON.stringify(salesOrders));
            
            // Show message
            alert(`Order ${orderId} rejected.\n\nReason: ${reason}\n\nSales Department has been notified.`);
            
            // Update UI
            updateDashboardStats();
            loadRecentPendingOrders();
            if (document.getElementById('pending-approvalsPage').style.display !== 'none') {
                loadAllPendingOrders();
            }
            
            currentOrder = null;
        }
        
        function createStoreRelease(orderId) {
            const order = salesOrders.find(o => o.id === orderId);
            if (!order) return;
            
            // Get existing store releases
            let storeReleases = JSON.parse(localStorage.getItem('store_pending_releases') || '[]');
            
            // Check if release already exists
            const existingRelease = storeReleases.find(release => release.orderId === orderId);
            if (existingRelease) {
                // Update existing release
                existingRelease.status = 'pending';
                existingRelease.approvedDate = new Date().toISOString();
            } else {
                // Create new release
                const newRelease = {
                    id: 'REL-' + Date.now(),
                    orderId: order.id,
                    customerName: order.customerName,
                    approvedDate: new Date().toISOString(),
                    deliveryDate: order.deliveryDate,
                    items: order.items.map(item => ({
                        productCode: item.product,
                        productName: item.product,
                        orderedQty: item.totalCartons,
                        unitPrice: item.totalValue / item.totalCartons,
                        cartonDetails: item
                    })),
                    totalValue: order.totalValue,
                    status: 'pending',
                    createdAt: new Date().toISOString()
                };
                storeReleases.push(newRelease);
            }
            
            // Save to localStorage
            localStorage.setItem('store_pending_releases', JSON.stringify(storeReleases));
        }
        
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-NG', {
                day: 'numeric',
                month: 'short',
                year: 'numeric'
            });
        }
        
        function formatPaymentMethod(method) {
            const methods = {
                'cash': 'Cash',
                'transfer': 'Bank Transfer',
                'pos': 'POS Payment',
                'bank_transfer': 'Bank Transfer',
                'cheque': 'Cheque',
                'online': 'Online Payment'
            };
            return methods[method] || method;
        }
        
        function getStatusText(status) {
            const statusMap = {
                'draft': 'Draft',
                'pending-accounts': 'Pending Accounts',
                'approved': 'Payment Approved',
                'pending-release': 'Pending Store Release',
                'delivered': 'Delivered',
                'cancelled': 'Cancelled',
                'rejected': 'Rejected'
            };
            return statusMap[status] || status;
        }
        
        function setupEventListeners() {
            // Sidebar menu
            document.querySelectorAll('.menu-item').forEach(item => {
                item.addEventListener('click', function() {
                    const pageName = this.dataset.page;
                    showPage(pageName);
                });
            });
            
            // Dashboard buttons
            document.getElementById('viewAllPendingBtn').addEventListener('click', () => showPage('pending-approvals'));
            document.getElementById('processBatchBtn').addEventListener('click', function() {
                alert('Bulk processing functionality would be implemented in production.');
            });
            
            // Pending approvals page
            document.getElementById('searchOrders').addEventListener('input', loadAllPendingOrders);
            document.getElementById('orderFilter').addEventListener('change', loadAllPendingOrders);
            
            // Approved orders page
            document.getElementById('filterApprovedBtn').addEventListener('click', loadApprovedOrders);
            
            // Rejected orders page
            document.getElementById('filterRejectedBtn').addEventListener('click', loadRejectedOrders);
            
            // Modal buttons
            document.getElementById('closeModal').addEventListener('click', function() {
                document.getElementById('approvalModal').style.display = 'none';
                currentOrder = null;
            });
            
            document.getElementById('cancelApprovalBtn').addEventListener('click', function() {
                document.getElementById('approvalModal').style.display = 'none';
                currentOrder = null;
            });
            
            document.getElementById('rejectOrderBtn').addEventListener('click', function() {
                if (currentOrder) {
                    document.getElementById('approvalModal').style.display = 'none';
                    rejectOrder(currentOrder.id, false);
                }
            });
            
            // Approval form
            document.getElementById('approvalForm').addEventListener('submit', function(e) {
                e.preventDefault();
                processApproval();
            });
            
            // Close modal when clicking outside
            window.addEventListener('click', function(e) {
                const modal = document.getElementById('approvalModal');
                if (e.target === modal) {
                    modal.style.display = 'none';
                    currentOrder = null;
                }
            });
            
            // Logout
            document.getElementById('logoutBtn').addEventListener('click', function() {
                if (confirm('Are you sure you want to logout?')) {
                    localStorage.removeItem('accounts_authenticated');
                    localStorage.removeItem('accounts_user');
                    window.location.href = 'login.html';
                }
            });
        }
    </script>
</body>
</html>